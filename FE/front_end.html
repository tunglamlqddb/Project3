<!DOCTYPE html>
<html>
  <body>
    <div class="form-group">
        <label for="NumberOfRecords">Number Records</label>
        <input
            type="number"
            class="form-control is-valid"
            id="inputSuccess"
            placeholder="Enter ..."
        />
    </div>
    <button onclick="query()">Query</button> <br/>
    <button onclick="create_co_authors()">Create co authors table</button> <br/>
    
    <label for="level"> Choose level of potential co author</label> 
    <select name="level" id="level">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
    </select> <br/>

    <button onclick="create_potential_co_authors()">Create potential co authors table</button> <br/>
    
    <button onclick="calculate_scores_and_label()">Calculate scores</button>

    <p id='result1'></p>
    <p id='result2'></p>
    <p id='result3'></p>
</body>

    <script>
        function query() {
            const num_records = document.getElementById('inputSuccess').value;
            fetch("http://127.0.0.1:5000/query", {
                method: 'POST',
                body: JSON.stringify({"num_records" : num_records}),
                headers: {'Content-Type': 'application/json',
                        "Access-Control-Allow-Origin": "*"
                }
            }).then(res => res.json())
            .then(result => {
                console.log("so luong paper", result['paper'][1].length)
                console.log("so luong author", result['author'][1].length)
                console.log("so luong paper_authors", result['paper_authors'][1].length)
                
               // view_query_result(result, ['1', '2', '3'])
            })
        }

        function create_co_authors() {
            const num_records = document.getElementById('inputSuccess').value;
            fetch("http://127.0.0.1:5000/create_co_authors", {
                method: 'POST',
                headers: {'Content-Type': 'application/json',
                        "Access-Control-Allow-Origin": "*"
                },
                body: JSON.stringify({"num_records" : num_records})
        }).then(res => res.json())
        .then(result => {
            console.log("so luong dong tac gia:", result['co_author'][1].length)
         //   view_co_author_table(result, '1')
        })
        }

        function create_potential_co_authors() {
            const num_records = document.getElementById('inputSuccess').value;
            const level = parseInt(document.getElementById('level').value);
            fetch("http://127.0.0.1:5000/create_potential_co_authors", {
                method: 'POST',
                headers: {'Content-Type': 'application/json',
                        "Access-Control-Allow-Origin": "*"
                },
                body: JSON.stringify({"num_records": num_records, "level": level})
            }).then(res => res.json())
            .then(result => {
                console.log("so luong ung vien", result['last_potential'][1].length)
           //     view_potential_table(result, 1)
            })
        }

        function calculate_scores_and_label() {
            const num_records = document.getElementById('inputSuccess').value;
            const level = parseInt(document.getElementById('level').value);
            fetch("http://127.0.0.1:5000/calculate_scores", {
                method: 'POST',
                headers: {'Content-Type': 'application/json',
                        "Access-Control-Allow-Origin": "*"
                },
                body: JSON.stringify({"num_records" : num_records, "level": level})
            }).then(res => res.json())
            .then(result => {
                console.log(result)
            })
        }

        function draw_table(data, id, column_names) {
            var html = ("<div>" + data.length + "</div>")   
            var keys = [];
            var html = ("<table border==\"1\"><tr>");
            for (var i = 0; i < column_names.length; i++) {
	            html += ('<td>' + column_names[i] + '</td>');
            }
            html += ("</tr>");
            for (var i = 0; i < data.length; i++) {
                html += ('<tr>');
                for (key in data[i]) {
                html += ('<td>' + data[i][key] + '</td>');
            }
                html += ('</tr>');
            }
            html += ("</table>");
            document.getElementById('result' +id).innerHTML = html;
        }

        function view_query_result(data, id) {

            draw_table(data['paper'][1], id[0], data['paper'][0])
            draw_table(data['author'][1], id[1], data['author'][0])
            draw_table(data['paper_authors'][1], id[2], data['paper_authors'][0])
        }
        function view_co_author_table(data, id) {
            draw_table(data['co_author'][1], id, data['co_author'][0])
        }
        function view_potential_table(data, id) {
            draw_table(data['last_potential'][1], id, data['last_potential'][0])
        }
        function view_scores() {}


    </script>

</html>
