<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="card">
      <div class="card-header">Training & Recommending</div>
      <div class="card-body">
    
        <div class="form-group">
        
        </div>

        <div class="form-group">
          <input type="file" multiple id="fileUpload" onclick="load_data()"/>
            <!-- Load data -->
        </div>

        <div class="form-group">
            <input
                type="number"
                class="form-control"
                id="test_percent"
                placeholder="Enter test percentage..."
            />
        </div>
        <div class="form-group">
          <button
            type="button"
            class="btn btn-primary"
            onclick="train()"
          >
            Train  ==> proportion of labels Return scores and acc
          </button>
        </div>

       

       

        
      </div>
    </div>

    <p id="result0">
    <p id="result1"></p>
    <p id="result2"></p>
    <p id="result3"></p>
  </body>

  <script>

    function load_data() {
      const data_name = document.getElementById('fileUpload').files[0]['name'];
      console.log(data_name);
    }

    function train() {
      const data_name = document.getElementById('fileUpload').files[0]['name'];
      const test_percent = document.getElementById('test_percent').value;
      fetch("http://127.0.0.1:5000/train", {
        method: "POST",
        body: JSON.stringify({ data_name: data_name, test_percent: test_percent }),
        headers: {
          "Content-Type": "application/json",
          "Access-Control-Allow-Origin": "*",
        },
      })
      .then((res) => res.json())
      .then((result) => {
        console.log("Precision: ", result['results']['Precision']);
        console.log("Recall: ", result['results']['Recall']);
        console.log("F1_score: ", result['results']['f1_score']);
        console.log("ROC_AUC: ", result['results']['Roc_auc']);
        console.log(result);
        show_training_results(result);
      })
    }
    
    function show_training_results(result) {
      var html = "<div> Kết quả mô hình trên tập test: </div><br>";
      html += "<div>" + "Precision: " + result['results']['Precision'] + "<div>";
      html += "<div>" + "Recall: " + result['results']['Recall'] + "<div>";
      html += "<div>" + "F1_score: " + result['results']['f1_score'] + "<div>";
      html += "<div>" + "ROC_AUC: " + result['results']['Roc_auc'] + "<div>";

    }
    
    function draw_table(data, id, column_names) {
      var html = "<div>" + data.length + "</div>";
      var keys = [];
      html += '<table border=="1"><tr>';
      for (var i = 0; i < column_names.length; i++) {
        html += "<td>" + column_names[i] + "</td>";
      }
      html += "</tr>";
      for (var i = 0; i < data.length; i++) {
        html += "<tr>";
        for (key in data[i]) {
          html += "<td>" + data[i][key] + "</td>";
        }
        html += "</tr>";
      }
      html += "</table>";
      document.getElementById("result" + id).innerHTML = html;
    }

   
    
  </script>
  <script
    src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
    crossorigin="anonymous"
  ></script>
</html>
